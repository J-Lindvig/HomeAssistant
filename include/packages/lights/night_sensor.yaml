night_sensor:

  input_number:
    sun_elevation_light:
      name: Under horisonten
      initial: 4
      min: 0
      max: 6
      step: 1
      icon: mdi:weather-sunset-down

  input_datetime:
    dim_time:
      name: DÃ¦mp lyset tidligst
      icon: mdi:clock
      has_date: false
      has_time: true

  template:
    - binary_sensor:
        - name: night
          unique_id: a81c57bfb0e241c3a02338c3929bb3d8
          state: >-
            {{
              state_attr('sun.sun', 'elevation') <= (0 - states('input_number.sun_elevation_light') | float )
              and
              (
                states('sensor.time') >= state_attr("input_datetime.dim_time", "timestamp") | int | timestamp_custom('%H:%M', false)
                or
                states('sensor.time') <= "07:00"
              )
            }}